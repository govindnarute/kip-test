{"version":3,"sources":["../../../src/utils/hooks/password.js"],"names":["PasswordHooks","beforeCreate","model","password","salt","PasswordHelper","generateSalt","hash","beforeUpdate","changed"],"mappings":";;;;;;;AAAA;;AAEO,MAAMA,aAAN,CAAoB;;AAEvB;;;;AAIA,WAAOC,YAAP,CAAoBC,KAApB,EAA2B;AACvB,YAAIA,MAAMC,QAAV,EAAoB;AAChBD,kBAAME,IAAN,GAAaC,+BAAeC,YAAf,EAAb;AACAJ,kBAAMC,QAAN,GAAiBE,+BAAeE,IAAf,CAAoBL,MAAMC,QAAN,GAAiBD,MAAME,IAA3C,CAAjB;AACH;AACJ;;AAED;;;;AAIA,WAAOI,YAAP,CAAoBN,KAApB,EAA2B;AACvB,YAAIA,MAAMC,QAAN,IAAkBD,MAAMO,OAAN,CAAc,UAAd,CAAtB,EAAiD;AAC7CP,kBAAME,IAAN,GAAaC,+BAAeC,YAAf,EAAb;AACAJ,kBAAMC,QAAN,GAAiBE,+BAAeE,IAAf,CAAoBL,MAAMC,QAAN,GAAiBD,MAAME,IAA3C,CAAjB;AACH;AACJ;AAtBsB;QAAdJ,a,GAAAA,a","file":"password.js","sourcesContent":["import { PasswordHelper } from '../../helpers/PasswordHelper';\n\nexport class PasswordHooks {\n\n    /**\n     * Hash password before create hook\n     * @param model\n     */\n    static beforeCreate(model) {\n        if (model.password) {\n            model.salt = PasswordHelper.generateSalt();\n            model.password = PasswordHelper.hash(model.password + model.salt);\n        }\n    }\n\n    /**\n     * Hash password and generate before update hook\n     * @param model\n     */\n    static beforeUpdate(model) {\n        if (model.password && model.changed('password')) {\n            model.salt = PasswordHelper.generateSalt();\n            model.password = PasswordHelper.hash(model.password + model.salt);\n        }\n    }\n}\n"]}